{"ast":null,"code":"/* eslint-disable @typescript-eslint/consistent-type-definitions */\nimport * as React from 'react';\nimport { createPopper as defaultCreatePopper } from '../popper-core/popper';\nimport { useIsomorphicLayoutEffect } from '../../../../helpers/useIsomorphicLayout';\nconst isEqual = (a, b) => JSON.stringify(a) === JSON.stringify(b);\n/**\n * Simple ponyfill for Object.fromEntries\n */\nconst fromEntries = entries => entries.reduce((acc, [key, value]) => {\n  acc[key] = value;\n  return acc;\n}, {});\nconst EMPTY_MODIFIERS = [];\nexport const usePopper = (referenceElement, popperElement, options = {}) => {\n  const prevOptions = React.useRef(null);\n  const optionsWithDefaults = {\n    onFirstUpdate: options.onFirstUpdate,\n    placement: options.placement || 'bottom',\n    strategy: options.strategy || 'absolute',\n    modifiers: options.modifiers || EMPTY_MODIFIERS\n  };\n  const [state, setState] = React.useState({\n    styles: {\n      popper: {\n        position: optionsWithDefaults.strategy,\n        left: '0',\n        top: '0'\n      }\n    },\n    attributes: {}\n  });\n  const updateStateModifier = React.useMemo(() => ({\n    name: 'updateState',\n    enabled: true,\n    phase: 'write',\n    // eslint-disable-next-line no-shadow\n    fn: ({\n      state\n    }) => {\n      const elements = Object.keys(state.elements);\n      setState({\n        styles: fromEntries(elements.map(element => [element, state.styles[element] || {}])),\n        attributes: fromEntries(elements.map(element => [element, state.attributes[element]]))\n      });\n    },\n    requires: ['computeStyles']\n  }), []);\n  const popperOptions = React.useMemo(() => {\n    const newOptions = {\n      onFirstUpdate: optionsWithDefaults.onFirstUpdate,\n      placement: optionsWithDefaults.placement,\n      strategy: optionsWithDefaults.strategy,\n      modifiers: [...optionsWithDefaults.modifiers, updateStateModifier, {\n        name: 'applyStyles',\n        enabled: false\n      }]\n    };\n    if (isEqual(prevOptions.current, newOptions)) {\n      return prevOptions.current || newOptions;\n    } else {\n      prevOptions.current = newOptions;\n      return newOptions;\n    }\n  }, [optionsWithDefaults.onFirstUpdate, optionsWithDefaults.placement, optionsWithDefaults.strategy, optionsWithDefaults.modifiers, updateStateModifier]);\n  const popperInstanceRef = React.useRef();\n  useIsomorphicLayoutEffect(() => {\n    if (popperInstanceRef && popperInstanceRef.current) {\n      popperInstanceRef.current.setOptions(popperOptions);\n    }\n  }, [popperOptions]);\n  useIsomorphicLayoutEffect(() => {\n    if (referenceElement == null || popperElement == null) {\n      return;\n    }\n    const createPopper = options.createPopper || defaultCreatePopper;\n    const popperInstance = createPopper(referenceElement, popperElement, popperOptions);\n    popperInstanceRef.current = popperInstance;\n    return () => {\n      popperInstance.destroy();\n      popperInstanceRef.current = null;\n    };\n  }, [referenceElement, popperElement, options.createPopper]);\n  return {\n    state: popperInstanceRef.current ? popperInstanceRef.current.state : null,\n    styles: state.styles,\n    attributes: state.attributes,\n    update: popperInstanceRef.current ? popperInstanceRef.current.update : null,\n    forceUpdate: popperInstanceRef.current ? popperInstanceRef.current.forceUpdate : null\n  };\n};","map":{"version":3,"sources":["../../../../../../src/helpers/Popper/thirdparty/react-popper/usePopper.ts"],"names":[],"mappings":"AAAA;AAEA,OAAO,KAAK,KAAK,MAAM,OAAO;AAC9B,SAAS,YAAY,IAAI,mBAAmB,QAAkD,uBAAuB;AACrH,SAAS,yBAAyB,QAAQ,yCAAyC;AAInF,MAAM,OAAO,GAAG,CAAC,CAAM,EAAE,CAAM,KAAK,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,KAAK,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;AAE3E;;AAEG;AACH,MAAM,WAAW,GAAI,OAAwB,IAC3C,OAAO,CAAC,MAAM,CAAC,CAAC,GAAQ,EAAE,CAAC,GAAG,EAAE,KAAK,CAAC,KAAI;EACxC,GAAG,CAAC,GAAG,CAAC,GAAG,KAAK;EAChB,OAAO,GAAG;AACZ,CAAC,EAAE,CAAA,CAAE,CAAC;AAmBR,MAAM,eAAe,GAAQ,EAAE;AAE/B,OAAO,MAAM,SAAS,GAAG,CACvB,gBAA+D,EAC/D,aAA6C,EAC7C,OAAA,GAAmB,CAAA,CAAE,KACnB;EACF,MAAM,WAAW,GAAG,KAAK,CAAC,MAAM,CAAmC,IAAI,CAAC;EAExE,MAAM,mBAAmB,GAAG;IAC1B,aAAa,EAAE,OAAO,CAAC,aAAa;IACpC,SAAS,EAAE,OAAO,CAAC,SAAS,IAAI,QAAQ;IACxC,QAAQ,EAAE,OAAO,CAAC,QAAQ,IAAI,UAAU;IACxC,SAAS,EAAE,OAAO,CAAC,SAAS,IAAI;GACjC;EAED,MAAM,CAAC,KAAK,EAAE,QAAQ,CAAC,GAAG,KAAK,CAAC,QAAQ,CAAQ;IAC9C,MAAM,EAAE;MACN,MAAM,EAAE;QACN,QAAQ,EAAE,mBAAmB,CAAC,QAAQ;QACtC,IAAI,EAAE,GAAG;QACT,GAAG,EAAE;MACN;KACF;IACD,UAAU,EAAE,CAAA;GACb,CAAC;EAEF,MAAM,mBAAmB,GAAG,KAAK,CAAC,OAAO,CACvC,OAAO;IACL,IAAI,EAAE,aAAa;IACnB,OAAO,EAAE,IAAI;IACb,KAAK,EAAE,OAAO;IACd;IACA,EAAE,EAAE,CAAC;MAAE;IAAK,CAAO,KAAI;MACrB,MAAM,QAAQ,GAAG,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC;MAE5C,QAAQ,CAAC;QACP,MAAM,EAAE,WAAW,CAAC,QAAQ,CAAC,GAAG,CAAC,OAAO,IAAI,CAAC,OAAO,EAAE,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAA,CAAE,CAAC,CAAC,CAAC;QACpF,UAAU,EAAE,WAAW,CAAC,QAAQ,CAAC,GAAG,CAAC,OAAO,IAAI,CAAC,OAAO,EAAE,KAAK,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC;OACtF,CAAC;IACJ,CAAC;IACD,QAAQ,EAAE,CAAC,eAAe;GAC3B,CAAC,EACF,EAAE,CACH;EAED,MAAM,aAAa,GAAG,KAAK,CAAC,OAAO,CAAC,MAAK;IACvC,MAAM,UAAU,GAAG;MACjB,aAAa,EAAE,mBAAmB,CAAC,aAAa;MAChD,SAAS,EAAE,mBAAmB,CAAC,SAAS;MACxC,QAAQ,EAAE,mBAAmB,CAAC,QAAQ;MACtC,SAAS,EAAE,CAAC,GAAG,mBAAmB,CAAC,SAAS,EAAE,mBAAmB,EAAE;QAAE,IAAI,EAAE,aAAa;QAAE,OAAO,EAAE;MAAK,CAAE;KAC3G;IAED,IAAI,OAAO,CAAC,WAAW,CAAC,OAAO,EAAE,UAAU,CAAC,EAAE;MAC5C,OAAO,WAAW,CAAC,OAAO,IAAI,UAAU;KACzC,MAAM;MACL,WAAW,CAAC,OAAO,GAAG,UAAU;MAChC,OAAO,UAAU;IAClB;EACH,CAAC,EAAE,CACD,mBAAmB,CAAC,aAAa,EACjC,mBAAmB,CAAC,SAAS,EAC7B,mBAAmB,CAAC,QAAQ,EAC5B,mBAAmB,CAAC,SAAS,EAC7B,mBAAmB,CACpB,CAAC;EAEF,MAAM,iBAAiB,GAAG,KAAK,CAAC,MAAM,CAAA,CAAO;EAE7C,yBAAyB,CAAC,MAAK;IAC7B,IAAI,iBAAiB,IAAI,iBAAiB,CAAC,OAAO,EAAE;MAClD,iBAAiB,CAAC,OAAO,CAAC,UAAU,CAAC,aAAa,CAAC;IACpD;EACH,CAAC,EAAE,CAAC,aAAa,CAAC,CAAC;EAEnB,yBAAyB,CAAC,MAAK;IAC7B,IAAI,gBAAgB,IAAI,IAAI,IAAI,aAAa,IAAI,IAAI,EAAE;MACrD;IACD;IAED,MAAM,YAAY,GAAG,OAAO,CAAC,YAAY,IAAI,mBAAmB;IAChE,MAAM,cAAc,GAAG,YAAY,CAAC,gBAAgB,EAAE,aAAa,EAAE,aAAa,CAAC;IAEnF,iBAAiB,CAAC,OAAO,GAAG,cAAc;IAE1C,OAAO,MAAK;MACV,cAAc,CAAC,OAAO,CAAA,CAAE;MACxB,iBAAiB,CAAC,OAAO,GAAG,IAAI;IAClC,CAAC;EACH,CAAC,EAAE,CAAC,gBAAgB,EAAE,aAAa,EAAE,OAAO,CAAC,YAAY,CAAC,CAAC;EAE3D,OAAO;IACL,KAAK,EAAE,iBAAiB,CAAC,OAAO,GAAG,iBAAiB,CAAC,OAAO,CAAC,KAAK,GAAG,IAAI;IACzE,MAAM,EAAE,KAAK,CAAC,MAAM;IACpB,UAAU,EAAE,KAAK,CAAC,UAAU;IAC5B,MAAM,EAAE,iBAAiB,CAAC,OAAO,GAAG,iBAAiB,CAAC,OAAO,CAAC,MAAM,GAAG,IAAI;IAC3E,WAAW,EAAE,iBAAiB,CAAC,OAAO,GAAG,iBAAiB,CAAC,OAAO,CAAC,WAAW,GAAG;GAClF;AACH,CAAC","sourceRoot":"","sourcesContent":["/* eslint-disable @typescript-eslint/consistent-type-definitions */\nimport * as React from 'react';\nimport { createPopper as defaultCreatePopper } from '../popper-core/popper';\nimport { useIsomorphicLayoutEffect } from '../../../../helpers/useIsomorphicLayout';\nconst isEqual = (a, b) => JSON.stringify(a) === JSON.stringify(b);\n/**\n * Simple ponyfill for Object.fromEntries\n */\nconst fromEntries = (entries) => entries.reduce((acc, [key, value]) => {\n    acc[key] = value;\n    return acc;\n}, {});\nconst EMPTY_MODIFIERS = [];\nexport const usePopper = (referenceElement, popperElement, options = {}) => {\n    const prevOptions = React.useRef(null);\n    const optionsWithDefaults = {\n        onFirstUpdate: options.onFirstUpdate,\n        placement: options.placement || 'bottom',\n        strategy: options.strategy || 'absolute',\n        modifiers: options.modifiers || EMPTY_MODIFIERS\n    };\n    const [state, setState] = React.useState({\n        styles: {\n            popper: {\n                position: optionsWithDefaults.strategy,\n                left: '0',\n                top: '0'\n            }\n        },\n        attributes: {}\n    });\n    const updateStateModifier = React.useMemo(() => ({\n        name: 'updateState',\n        enabled: true,\n        phase: 'write',\n        // eslint-disable-next-line no-shadow\n        fn: ({ state }) => {\n            const elements = Object.keys(state.elements);\n            setState({\n                styles: fromEntries(elements.map(element => [element, state.styles[element] || {}])),\n                attributes: fromEntries(elements.map(element => [element, state.attributes[element]]))\n            });\n        },\n        requires: ['computeStyles']\n    }), []);\n    const popperOptions = React.useMemo(() => {\n        const newOptions = {\n            onFirstUpdate: optionsWithDefaults.onFirstUpdate,\n            placement: optionsWithDefaults.placement,\n            strategy: optionsWithDefaults.strategy,\n            modifiers: [...optionsWithDefaults.modifiers, updateStateModifier, { name: 'applyStyles', enabled: false }]\n        };\n        if (isEqual(prevOptions.current, newOptions)) {\n            return prevOptions.current || newOptions;\n        }\n        else {\n            prevOptions.current = newOptions;\n            return newOptions;\n        }\n    }, [\n        optionsWithDefaults.onFirstUpdate,\n        optionsWithDefaults.placement,\n        optionsWithDefaults.strategy,\n        optionsWithDefaults.modifiers,\n        updateStateModifier\n    ]);\n    const popperInstanceRef = React.useRef();\n    useIsomorphicLayoutEffect(() => {\n        if (popperInstanceRef && popperInstanceRef.current) {\n            popperInstanceRef.current.setOptions(popperOptions);\n        }\n    }, [popperOptions]);\n    useIsomorphicLayoutEffect(() => {\n        if (referenceElement == null || popperElement == null) {\n            return;\n        }\n        const createPopper = options.createPopper || defaultCreatePopper;\n        const popperInstance = createPopper(referenceElement, popperElement, popperOptions);\n        popperInstanceRef.current = popperInstance;\n        return () => {\n            popperInstance.destroy();\n            popperInstanceRef.current = null;\n        };\n    }, [referenceElement, popperElement, options.createPopper]);\n    return {\n        state: popperInstanceRef.current ? popperInstanceRef.current.state : null,\n        styles: state.styles,\n        attributes: state.attributes,\n        update: popperInstanceRef.current ? popperInstanceRef.current.update : null,\n        forceUpdate: popperInstanceRef.current ? popperInstanceRef.current.forceUpdate : null\n    };\n};\n//# sourceMappingURL=usePopper.js.map"]},"metadata":{},"sourceType":"module"}